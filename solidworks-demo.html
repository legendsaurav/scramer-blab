<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SolidWorks Launcher Demo</title>
    <style>
      body { font-family: system-ui, sans-serif; background: #0f172a; color: #f8fafc; display: grid; place-items: center; height: 100vh; }
      .card { background: #0b1220; border: 1px solid #1f2937; border-radius: 16px; padding: 24px; width: 360px; }
      button { background: #dc2626; color: white; border: none; border-radius: 10px; padding: 12px 16px; font-weight: 700; cursor: pointer; }
      button:hover { background: #ef4444; }
      .status { margin-top: 12px; font-size: 12px; color: #93c5fd; }
      .error { color: #fca5a5; }
    </style>
  </head>
  <body>
    <div class="card">
      <h3>Open SolidWorks</h3>
      <p style="font-size: 12px; color:#cbd5e1;">Requires local launcher listening on <strong>http://localhost:5000</strong>.</p>
      <button id="openSW">Open SolidWorks</button>
      <div id="status" class="status"></div>
    </div>

    <script>
      const btn = document.getElementById('openSW');
      const statusEl = document.getElementById('status');
      btn.addEventListener('click', async () => {
        statusEl.textContent = 'Attempting to open SolidWorksâ€¦';
        try {
          const res = await fetch('http://localhost:5000/open-solidworks', { method: 'POST', headers: { 'Content-Type': 'application/json' } });
          if (res.ok) {
            statusEl.textContent = 'SolidWorks opening (if installed).';
          } else {
            const body = await res.json().catch(() => ({}));
            statusEl.innerHTML = `<span class="error">Error: ${body.error || 'Failed to open SolidWorks'}</span>`;
          }
        } catch (e) {
          statusEl.innerHTML = '<span class="error">Launcher not running on localhost:5000</span>';
        }
      });
    </script>
  </body>
</html>
